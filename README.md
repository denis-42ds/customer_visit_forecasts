# Название проекта: Построение ML продукта для предсказания визитов клиентов

## Заказчик: Mains Lab

## Статус проекта: в работе

## Описание рабочих файлов:
- `requirements.txt` - библиотеки Python, необходимые для работы проекта, а также их версии
- `visits_number_predict.ipynb` - рабочая тетрадь с исследованиями, визуализациями и текстовыми описаниями
- `run_mlflow_server.sh` - скрипт для запуска mlflow server

## Описание проекта

[mle_предсказание_количества_визитов](https://incredible-tulip-5c3.notion.site/Machine-learning-engineer-2024-e4c30223002a4eebb33d2cdeb8f81fb1)

**Формулировка задачи:**

Доступны данные о количестве обращений за медицинской помощью по 50 000 застрахованным ДМС за 2022 год.
<br>Требуется на основании характеристик застрахованных и истории их обращений за 2022 год предсказать количество визитов за 2023 год. 

Доступны 2 выборки: 

- train - выборка для обучения и валидации , 50 тыс. застрахованных с проставленными значениями target.
- holdout - выборка для финального замера качества модели. В этой выборке 10 000 застрахованных, истинные значения target скрыты.

Для оценки качества модели будет применяться метрика `MSE`.

**Описание данных:**

- `Insured_PIN` - уникальный ид застрахованного лица
- `Insured_Network` - Идентификатор сети клиник доступной для застрахованного. Network - 1 - клиники с наивысшим уровнем сервиса, Network - 8 - клиники с самым базовым уровнем сервиса.
- `Nationality` - национальность застрахованного.
- `Gender` - пол застрахованного
- `Relation - в качестве кого застраховано данное лицо. self - работник организации, которая оформляет страховку, child - ребенок застрахованного и т.д.
- `DoB - дата рождения застрахованного
- `Diagnoses - все диагнозы застрахованного за 2022 год
- `HasChronicDisease - флаг хронического пациента
- `Exposition_22 - количество дней в 2022 году в которые у данного застрахованного действовал полис медицинского страхования. Значение 365 говорит о том, что застрахованный мог обращаться за медицинской помощью весь 2022 год
- `number_of_visits_22 - количество дней в 2022 году в которые застрахованный посещал клинику для получения медицинской помощи
- `number_of_services_22 - количество оказанных медицинских услуг в 2022 году (консультации, анализы, лекарства и т.д.)
- `Exposition_23 - количество дней в 2023 году в которые у данного застрахованного действовал полис медицинского страхования. Значение 365 говорит о том, что застрахованный мог обращаться за медицинской помощью весь 2023 год
- **Target -** `number_of_visits_23` - количество дней в 2023 году в которые застрахованный посещал клинику для получения медицинской помощи.

**Ход исследования**

- загрузка данных и ознакомление с ними;
- первичная обработка данных;
- исследовательский анализ данных;
- создание новых признаков (при необходимости);
- отбор финального набора обучающих признаков;
- подготовка данных для обучения;
- выбор и обучение моделей;
- оценка качества предсказания лучшей модели на тестовой выборке;
- анализ важности признаков лучшей модели;
- прогноз для отложенных данных;
- отчёт по проведённому исследованию.
